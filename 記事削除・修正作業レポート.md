# IELTSコンサルサイト 記事削除・修正作業レポート

## 📋 作業概要

https://ieltsconsult.netlify.app/ において、以下の2つの作業を実施する必要があります。

### ① 有料note記事の削除
「📚 続きはnoteで公開中！」というテキストが本文に含まれている記事で、Noteで有料販売している記事については削除する（無料の記事のみ掲載するようにする）

### ② 特定セクションの削除
以下のセクションをすべての記事から削除する：
- 「この記事について」セクション
- 「この記事を読む前に」セクション
- 「📌 この記事は、noteで公開された記事を要約・転載したものです...」という注釈
- 「📌 この記事で学べる主要なポイント」セクション
- 「📄 この記事について」セクション
- 「この記事から学べること」セクション
- その他、note記事への言及や要約版であることを示すテキスト

---

## 🔍 現状分析

### サイト構造

#### 1. 記事の保存形式
- **HTMLファイル**: プロジェクトルートに `n*.html` 形式で37個のHTMLファイルが存在
  - 例: `ne68beb472a95.html`, `n70a885fec234.html`, `n73ea63a15482.html` など
- **MDXファイル**: `content/posts/` ディレクトリ（現在は空）
- **読み込み処理**: `lib/posts.ts` でHTMLファイルから記事を読み込み

#### 2. 記事表示ページ
- **ファイル**: `app/posts/[slug]/page.tsx`
- **表示内容**:
  - 記事ヘッダー（タイトル、日付、タグ）
  - 出典表示（`ArticleSource`コンポーネント）
  - 記事導入（`ArticleIntro`コンポーネント）
  - 「この記事で学べる主要なポイント」セクション（ハードコード）
  - 「📄 この記事について」セクション（ハードコード）
  - 記事本文（HTMLコンテンツ）
  - 「この記事の重要なポイント」セクション（ハードコード）
  - 記事洞察（`ArticleInsights`コンポーネント）
  - noteへのCTA（`NoteCTA`コンポーネント）

#### 3. 削除対象の配置場所

##### A. HTMLファイル内（記事本文）
- **場所**: 各HTMLファイル（`n*.html`）の本文内
- **内容**: 
  ```html
  <h2>📚 続きはnoteで公開中！</h2>
  <p>この記事の続きは、より詳しい解説と実践的なテクニックを含めてnoteで公開しています。</p>
  <p style="text-align: center; margin: 30px 0;">
  <a href="[note URL]" target="_blank" rel="noopener noreferrer" style="...">📖 noteで続きを読む</a>
  </p>
  <hr>
  <p style="text-align: center; color: #666; font-size: 14px;">
  💡 より詳しい実践例・フレーズ集・Q&A・学習スケジュールなど、<br>
  有料級のコンテンツをnoteで公開中です！
  </p>
  ```
- **影響範囲**: 37個のHTMLファイルすべてに含まれている可能性が高い

##### B. Reactコンポーネント内

**① `components/article-source.tsx`**
- **表示内容**:
  - 「この記事について」見出し
  - 「この記事は、noteで公開された記事を要約・転載したものです。より詳しい解説、実践例、追加情報については、元のnote記事をご覧ください。」
  - 「元のnote記事を読む」リンク
- **使用箇所**: `app/posts/[slug]/page.tsx` の210行目

**② `components/article-intro.tsx`**
- **表示内容**:
  - 「この記事を読む前に」見出し
  - 記事の背景説明
  - 「📌 この記事は、noteで公開された記事を要約・転載したものです。より詳しい解説や実践例については、記事冒頭の出典リンクから元のnote記事をご覧ください。」
- **使用箇所**: `app/posts/[slug]/page.tsx` の213-218行目

**③ `components/article-insights.tsx`**
- **表示内容**:
  - 「この記事から学べること」見出し
  - 「主要なポイント」セクション
  - 「次のステップ」セクション
  - 「💡 この記事は、noteで公開された記事を要約・転載したものです。より詳しい解説や追加情報については、記事冒頭の出典リンクから元のnote記事をご覧ください。」
- **使用箇所**: `app/posts/[slug]/page.tsx` の319-323行目

**④ `app/posts/[slug]/page.tsx` 内のハードコードされたセクション**

**a) 「📌 この記事で学べる主要なポイント」セクション（221-279行目）**
```tsx
<div className="bg-gradient-to-r from-blue-50 to-indigo-50 ...">
  <h2 className="text-xl font-bold mb-4 text-blue-900 dark:text-blue-100">
    📌 この記事で学べる主要なポイント
  </h2>
  <div className="space-y-3">
    {/* 複数のポイント説明 */}
    <div>
      <h3>4. より深い理解のためのリソース</h3>
      <p>この記事は要約版です。より詳しい解説、追加の実践例、Q&A、学習スケジュールなどは、記事冒頭の出典リンクから元のnote記事でご覧いただけます。</p>
    </div>
  </div>
</div>
```

**b) 「📄 この記事について」セクション（286-293行目）**
```tsx
<div className="bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4 mb-6">
  <p className="text-sm text-amber-900 dark:text-amber-100 font-medium mb-1">
    📄 この記事について
  </p>
  <p className="text-xs text-amber-800 dark:text-amber-200">
    以下は、noteで公開された記事の要約版です。記事の要点をまとめており、より詳しい解説や実践例については、記事冒頭の出典リンクから元のnote記事をご覧ください。
  </p>
</div>
```

**c) 「💡 この記事の重要なポイント」セクション（301-313行目）**
```tsx
<div className="bg-slate-50 dark:bg-slate-900/50 rounded-lg p-6 mb-8 border border-slate-200 dark:border-slate-800">
  <h3 className="text-lg font-semibold mb-3 text-slate-900 dark:text-slate-100">
    💡 この記事の重要なポイント
  </h3>
  {/* 説明文 */}
</div>
```

##### C. 構造化データ（JSON-LD）
- **場所**: `app/posts/[slug]/page.tsx` の122-159行目
- **内容**: 
  ```json
  {
    "isBasedOn": {
      "@type": "Article",
      "url": noteUrl,
      "name": post.title
    },
    "citation": noteUrl
  }
  ```
- **注意**: これはSEO用の構造化データなので、削除するかどうかは要検討

---

## 🎯 作業タスク詳細

### タスク1: 有料note記事の特定と削除

#### 1.1 有料記事の特定方法
- 各HTMLファイル内に「📚 続きはnoteで公開中！」が含まれているか確認
- 該当記事のnote URLを抽出（例: `https://note.com/ielts_consult/n/ne68beb472a95`）
- noteのAPIまたは手動で各記事が有料か無料かを確認
- 有料記事のHTMLファイルを削除または非表示にする

#### 1.2 実装方法の選択肢

**方法A: HTMLファイルを削除**
- 有料記事のHTMLファイルを物理的に削除
- `lib/posts.ts` の `getAllHtmlPosts()` 関数で自動的に除外される
- **メリット**: シンプル、確実
- **デメリット**: 後で復元する場合に手間

**方法B: フィルタリング機能を追加**
- `lib/posts.ts` に有料記事のスラッグリストを定義
- `getAllHtmlPosts()` で有料記事を除外
- **メリット**: 後で復元しやすい
- **デメリット**: 管理が必要

**推奨**: 方法B（フィルタリング機能）

#### 1.3 必要なファイル変更
- `lib/posts.ts`: 有料記事フィルターを追加
- 有料記事リストファイル（新規作成）: `config/paid-articles.ts` など

### タスク2: 特定セクションの削除

#### 2.1 HTMLファイル内の削除
- 各HTMLファイルから「📚 続きはnoteで公開中！」セクションを削除
- 正規表現またはDOM操作で削除

#### 2.2 Reactコンポーネントの削除/修正

**① `components/article-source.tsx`**
- コンポーネント全体を削除、または
- `app/posts/[slug]/page.tsx` から呼び出しを削除（210行目）

**② `components/article-intro.tsx`**
- コンポーネント全体を削除、または
- `app/posts/[slug]/page.tsx` から呼び出しを削除（213-218行目）
- または、noteへの言及部分のみ削除（52-54行目）

**③ `components/article-insights.tsx`**
- コンポーネント全体を削除、または
- `app/posts/[slug]/page.tsx` から呼び出しを削除（319-323行目）
- または、noteへの言及部分のみ削除（95-98行目）

**④ `app/posts/[slug]/page.tsx` のハードコード削除**
- 221-279行目: 「📌 この記事で学べる主要なポイント」セクション全体を削除
- 286-293行目: 「📄 この記事について」セクション全体を削除
- 301-313行目: 「💡 この記事の重要なポイント」セクション全体を削除

#### 2.3 構造化データの対応
- `isBasedOn` と `citation` フィールドを削除するか、空にする
- または、そのまま残す（SEO的には問題ない可能性）

---

## 📝 ChatGPT用プロンプト案

```
あなたは、Next.jsで構築されたIELTS対策ブログサイトの修正作業を担当するエンジニアです。

【現状】
- サイトURL: https://ieltsconsult.netlify.app/
- 記事はHTMLファイル（n*.html形式、37個）として保存されている
- Next.js App Routerを使用
- 記事は `lib/posts.ts` で読み込まれ、`app/posts/[slug]/page.tsx` で表示される

【作業内容】

① 有料note記事の削除
- HTMLファイル内に「📚 続きはnoteで公開中！」というテキストが含まれている記事がある
- これらの記事のうち、noteで有料販売されている記事を特定し、サイトから削除する
- 無料の記事のみをサイトに掲載するようにする

② 特定セクションの削除
以下のセクションをすべての記事から削除する必要があります：

1. 「この記事について」セクション
   - 場所: `components/article-source.tsx` と `app/posts/[slug]/page.tsx` の286-293行目
   - 内容: 「この記事は、noteで公開された記事を要約・転載したものです...」

2. 「この記事を読む前に」セクション
   - 場所: `components/article-intro.tsx`
   - 内容: 記事の背景説明とnoteへの言及

3. 「📌 この記事で学べる主要なポイント」セクション
   - 場所: `app/posts/[slug]/page.tsx` の221-279行目
   - 内容: 複数のポイント説明と「この記事は要約版です...」という記述

4. 「📄 この記事について」セクション
   - 場所: `app/posts/[slug]/page.tsx` の286-293行目
   - 内容: 「以下は、noteで公開された記事の要約版です...」

5. 「この記事から学べること」セクション
   - 場所: `components/article-insights.tsx`
   - 内容: 学習ポイントとnoteへの言及

6. HTMLファイル内の「📚 続きはnoteで公開中！」セクション
   - 場所: 各HTMLファイル（n*.html）の本文内
   - 内容: noteへのCTAとリンク

7. その他、note記事への言及や要約版であることを示すテキスト

【実装方針】
1. 有料記事のフィルタリング機能を `lib/posts.ts` に追加
2. 不要なコンポーネントの呼び出しを `app/posts/[slug]/page.tsx` から削除
3. HTMLファイル内のnote CTAセクションを一括削除するスクリプトを作成
4. 構造化データ（JSON-LD）の `isBasedOn` と `citation` フィールドを削除

【注意事項】
- 記事の本文コンテンツ自体は保持する
- noteへのCTAや要約版である旨の記述のみを削除
- SEOへの影響を最小限に抑える

上記の作業を実施するための具体的なコード変更案を提示してください。
```

---

## 🔧 実装手順（参考）

### ステップ1: 有料記事リストの作成
1. 各HTMLファイルを確認し、「📚 続きはnoteで公開中！」を含む記事を特定
2. 各記事のnote URLを抽出
3. noteで有料か無料かを確認
4. `config/paid-articles.ts` に有料記事のスラッグリストを作成

### ステップ2: フィルタリング機能の追加
1. `lib/posts.ts` を修正して有料記事を除外

### ステップ3: HTMLファイル内のnote CTA削除
1. スクリプトを作成してHTMLファイルから「📚 続きはnoteで公開中！」セクションを一括削除

### ステップ4: Reactコンポーネントの削除
1. `app/posts/[slug]/page.tsx` から不要なコンポーネント呼び出しを削除
2. ハードコードされたセクションを削除

### ステップ5: 構造化データの修正
1. `app/posts/[slug]/page.tsx` の構造化データからnote関連フィールドを削除

### ステップ6: テスト
1. ローカル環境で動作確認
2. 有料記事が表示されないことを確認
3. 不要なセクションが表示されないことを確認

---

## 📊 影響範囲

### 削除されるコンポーネント
- `components/article-source.tsx` - 使用停止
- `components/article-intro.tsx` - 使用停止（または修正）
- `components/article-insights.tsx` - 使用停止（または修正）

### 修正が必要なファイル
- `lib/posts.ts` - フィルタリング機能追加
- `app/posts/[slug]/page.tsx` - セクション削除、コンポーネント呼び出し削除
- 37個のHTMLファイル - note CTAセクション削除

### 新規作成が必要なファイル
- `config/paid-articles.ts` - 有料記事リスト
- `scripts/remove-note-cta.ts` - HTMLファイル修正スクリプト（オプション）

---

## ⚠️ 注意事項

1. **バックアップ**: 作業前に全ファイルのバックアップを取得
2. **段階的実装**: 一度にすべてを変更せず、段階的に実装してテスト
3. **SEO影響**: 構造化データの変更がSEOに与える影響を考慮
4. **有料記事の確認**: noteで有料か無料かを正確に確認する必要がある
5. **コンテンツの整合性**: 記事本文は保持し、CTAや注釈のみを削除

---

## 📌 次のステップ

1. このレポートをChatGPTに入力して具体的な実装コードを生成
2. 有料記事リストを作成
3. 段階的に実装を進める
4. テストと確認
